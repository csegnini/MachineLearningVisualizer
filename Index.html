  <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
<link href="https://unpkg.com/vis-network/styles/vis-network.min.css" rel="stylesheet" type="text/css" />
<style>

body {
  font: 10pt sans;
}

#mynetwork {
  width: 90vw;
  height: 90vh;
}
</style>

<div id="mynetwork"></div>
<p id="selection"></p>

<script>
var nodes = null;
var edges = null;
var network = null;
var directionInput = "UD";

function destroy() { if (network !== null) { network.destroy(); network = null; }}

function parseXML(xmlString) { /* ... */ }

function draw() {
  destroy();
  nodes = [];
  edges = [];
  var connectionCount = [];

    var xmlDoc;
    var xhr = new XMLHttpRequest();
    xhr.open("GET", "indexes.xml", false);
    xhr.send();
    if (xhr.status === 200) {
      xmlDoc = new DOMParser().parseFromString(xhr.responseText, "application/xml");
    }

    // 1. Parse XML
    let xmlDoc = parseXML(xmlData); // Assuming xmlData holds your XML
    
    // 2. Extract Nodes
    let xmlNodes = xmlDoc.querySelectorAll('Workflow > Dataset > node, Workflow > Deployment > node, ...'); // Adjust selector as needed
    xmlNodes.forEach(xmlNode => {
        let id = parseInt(xmlNode.getAttribute('num'));
        let label = xmlNode.getAttribute('dir');
        let level = parseInt(xmlNode.getAttribute('level'));
        nodes.push({ id: id, label: label, level: level });
    });

    // 3. Extract Edges
    let xmlEdges = xmlDoc.querySelectorAll('Workflow > Dataset > node, Workflow > Deployment > node, ...'); // Adjust selector as needed
    xmlEdges.forEach(xmlNode => {
        let from = parseInt(xmlNode.getAttribute('num'));
        let to = parseInt(xmlNode.getAttribute('from'));
        if (from !== to) {
          edges.push({ from: from, to: to });
        }
    });




  // create a network
  var container = document.getElementById("mynetwork");
  var data = {
    nodes: nodes,
    edges: edges,
  };

  var options = {
    edges: {
      smooth: {
        type: "cubicBezier",
        forceDirection: "horizontal",
        roundness: 0.4,
      },
    },
    layout: {
      hierarchical: {
        direction: directionInput,
      },
    },
    physics: false,
  };
  network = new vis.Network(container, data, options);
  
  
  // add event listeners
  network.on("select", function (params) {
    document.getElementById("selection").innerText =
      "Selection: " + params.nodes;  })}
directionInput = "LR";
window.addEventListener("load", () => {draw()});



//function olddraw() {
  // randomly create some nodes and edges
//  for (var i = 0; i < 98; i++) {
//    nodes.push({ id: i, label: String(i) });
//  }
  
//  edges.push({ from: 0, to: 1 });
//  nodes[0]["level"] = 0;
//
  // add event listeners
//  network.on("select", function (params) {
//    document.getElementById("selection").innerText =
//      "Selection: " + params.nodes;  })}


    </script>
</body>
</html>

